<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒê¸°ë¶€ ì‹¬í™” ë³´ì™„ ë° 3í•™ë…„ ì™„ê²° ë³´ê³ ì„œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        :root { --p: #6366f1; --s: #10b981; --bg: #0f172a; --card: #1e293b; --text: #f1f5f9; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: var(--text); line-height: 1.7; padding: 20px; }
        .wrap { max-width: 1100px; margin: 0 auto; }
        .card { background: var(--card); border-radius: 16px; padding: 30px; margin-bottom: 25px; border: 1px solid rgba(255,255,255,0.1); }
        h1 { font-size: 2.2rem; text-align: center; background: linear-gradient(to right, #818cf8, #34d399); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }
        .upload-zone { border: 2px dashed #475569; border-radius: 12px; padding: 30px; text-align: center; cursor: pointer; background: rgba(0,0,0,0.1); margin: 20px 0; }
        .input-group { display: flex; gap: 10px; margin-bottom: 15px; }
        input, textarea { width: 100%; padding: 14px; background: #0f172a; border: 1px solid #334155; border-radius: 10px; color: #fff; box-sizing: border-box; }
        .btn-main { width: 100%; padding: 20px; background: linear-gradient(135deg, var(--p), #8b5cf6); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; font-size: 1.2rem; }

        .section-title { font-size: 1.4rem; color: #a5b4fc; border-left: 5px solid var(--p); padding-left: 15px; margin: 35px 0 20px; font-weight: 700; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 25px; }
        th, td { border: 1px solid #334155; padding: 15px; text-align: left; }
        th { background: rgba(99,102,241,0.15); }
        .deep-box { background: rgba(16,185,129,0.05); border: 1px solid rgba(16,185,129,0.2); border-radius: 10px; padding: 20px; margin-top: 15px; }
        .strategy-item { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .strategy-tag { display: inline-block; padding: 3px 10px; border-radius: 5px; font-size: 0.8rem; font-weight: 700; margin-bottom: 8px; }
        #loading { display: none; text-align: center; padding: 60px; }
        .spinner { border: 5px solid rgba(255,255,255,0.1); border-top: 5px solid var(--p); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="wrap">
    <div class="card" style="text-align: center;">
        <h1>ìƒê¸°ë¶€ ì„±ì¥ ë¶„ì„ ë° 3í•™ë…„ ì‹¬í™” ê°€ì´ë“œ</h1>
        <p style="color: #94a3b8;">ììœ¨Â·ì§„ë¡œÂ·ë™ì•„ë¦¬ ì‹¬í™” ë³´ì™„ ë° ê¸°ì¬ í¬ì¸íŠ¸ ìë™ ìƒì„±</p>
    </div>

    <div class="card">
        <input type="password" id="apiKey" placeholder="Gemini API Key (sk-...)">
        <div class="input-group" style="margin-top:15px">
            <input type="text" id="name" placeholder="í•™ìƒ ì„±ëª…">
            <input type="text" id="major" placeholder="í¬ë§ ì§„ë¡œ/í•™ê³¼">
        </div>
        <div id="drop-zone" class="upload-zone">
            <div id="upload-status">ğŸ“„ ìƒê¸°ë¶€ PDFë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
            <input type="file" id="file-input" accept=".pdf" style="display: none;">
        </div>
        <textarea id="rawText" style="display:none;"></textarea>
    </div>

    <button class="btn-main" onclick="runAnalysis()">ğŸ” ì‹¬í™” ë³´ì™„ ë³´ê³ ì„œ ìƒì„±</button>

    <div id="loading">
        <div class="spinner"></div>
        <p>ììœ¨/ì§„ë¡œ/ë™ì•„ë¦¬ë³„ ì‹¬í™” ë³´ì™„ í¬ì¸íŠ¸ë¥¼ ì„¤ê³„ ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>

    <div id="result"></div>
</div>

<script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');

    dropZone.onclick = () => fileInput.click();
    fileInput.onchange = (e) => handleFile(e.target.files[0]);
    dropZone.ondragover = (e) => e.preventDefault();
    dropZone.ondrop = async (e) => { e.preventDefault(); handleFile(e.dataTransfer.files[0]); };

    async function handleFile(file) {
        if (!file || file.type !== 'application/pdf') return;
        document.getElementById('upload-status').innerHTML = "â³ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì¤‘...";
        const pdf = await pdfjsLib.getDocument({data: await file.arrayBuffer()}).promise;
        let text = '';
        for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            text += (await page.getTextContent()).items.map(t => t.str).join(' ') + '\n';
        }
        document.getElementById('rawText').value = text;
        document.getElementById('upload-status').innerHTML = `âœ… ${file.name} ì¤€ë¹„ ì™„ë£Œ!`;
    }

    async function runAnalysis() {
        const key = document.getElementById('apiKey').value;
        const text = document.getElementById('rawText').value;
        if(!key || !text) return alert("ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”.");

        document.getElementById('loading').style.display = 'block';
        document.getElementById('result').innerHTML = '';

        const sys = `ë‹¹ì‹ ì€ ì…ì‹œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. 1,2í•™ë…„ ìƒê¸°ë¶€ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ 5ë‹¨ êµ¬ì„±ì„ JSONìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.
        1. growth_table: ì—­ëŸ‰ë³„ 1,2í•™ë…„ ë¹„êµ ë¶„ì„
        2. deep_guide: [ììœ¨í™œë™, ì§„ë¡œí™œë™, ë™ì•„ë¦¬í™œë™] ê°ê°ì— ëŒ€í•œ '3í•™ë…„ ì‹¬í™” ë³´ì™„ ì¶”ê°€ ë‚´ìš©' (êµ¬ì²´ì  íƒêµ¬ ì£¼ì œ ë° ì—°ê²°ê³ ë¦¬ í¬í•¨)
        3. record_points: ì˜ì—­ë³„ ìƒê¸°ë¶€ ê¸°ì¬ í•µì‹¬ í¬ì¸íŠ¸ (ê³¼ì • ì¤‘ì‹¬ ê¸°ë¡ ë°©ë²•)
        4. finishing_tips: ë™ì•„ë¦¬ ë° í™œë™ ë§ˆë¬´ë¦¬ ë°©ì•ˆ (ê²°ê³¼ë¬¼ ì™„ì„±ë„ ë° ì„±ì°° ì¼ì§€ ê°€ì´ë“œ)
        5. books: íƒêµ¬ì˜ ê¹Šì´ë¥¼ ë”í•´ì¤„ ì‹¬í™” ì„œì  3ê¶Œ`;

        try {
            const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=${key}`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    contents: [{parts: [{text: sys + "\n\në°ì´í„°:\n" + text}]}],
                    generationConfig: {response_mime_type: "application/json"}
                })
            });
            render(JSON.parse((await resp.json()).candidates[0].content.parts[0].text));
        } catch (e) { alert("ë¶„ì„ ì‹¤íŒ¨."); } finally { document.getElementById('loading').style.display = 'none'; }
    }

    function render(res) {
        let table = res.growth_table.map(i => `<tr><th>${i.cat}</th><td><strong>1í•™ë…„:</strong> ${i.g1}</td><td><strong>2í•™ë…„:</strong> ${i.g2}</td><td>${i.growth}</td></tr>`).join('');
        
        let deepGuides = res.deep_guide.map(g => `
            <div class="strategy-item">
                <div class="strategy-tag" style="background:var(--p)">${g.category}</div>
                <h4>${g.title || 'ì‹¬í™” ë³´ì™„ ì „ëµ'}</h4>
                <p>${g.content}</p>
                <div class="deep-box">ğŸ’¡ <strong>ì¶”ê°€ íƒêµ¬ í¬ì¸íŠ¸:</strong> ${g.deep_point}</div>
            </div>
        `).join('');

        document.getElementById('result').innerHTML = `
            <div class="card"><div class="section-title">1. ì—­ëŸ‰ ì„±ì¥ ë¶„ì„í‘œ</div><table>${table}</table></div>
            
            <div class="card"><div class="section-title">2. ììœ¨Â·ì§„ë¡œÂ·ë™ì•„ë¦¬ ì‹¬í™” ë³´ì™„ ì¶”ê°€ ë‚´ìš©</div>
                ${deepGuides}
            </div>

            <div class="card"><div class="section-title">3. ì˜ì—­ë³„ ìƒê¸°ë¶€ ê¸°ë¡ í•µì‹¬ í¬ì¸íŠ¸</div>
                <p><strong>ì§„ë¡œì—­ëŸ‰ ì‹¬í™”:</strong> ${res.record_points.career}</p>
                <p><strong>í•™ì—…ì—­ëŸ‰ í™•ì¥:</strong> ${res.record_points.academic}</p>
                <p><strong>ê³µë™ì²´ì—­ëŸ‰ ì„±ìˆ™:</strong> ${res.record_points.community}</p>
            </div>

            <div class="card"><div class="section-title">4. í™œë™ ë§ˆë¬´ë¦¬ ë° ì™„ì„±ë„ ì œê³  ë°©ì•ˆ</div>
                <p>${res.finishing_tips}</p>
            </div>

            <div class="card"><div class="section-title">5. íƒêµ¬ ë§¤ë“­ì„ ìœ„í•œ ì‹¬í™” ì¶”ì²œ ë„ì„œ</div>
                ${res.books.map(b => `<p>ğŸ“˜ <strong>${b.title}</strong>: ${b.reason}</p>`).join('')}
            </div>
        `;
    }
</script>
</body>
</html>
