<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒê¸°ë¶€ ì„±ì¥ ë¶„ì„ ë° 3í•™ë…„ ì „ëµ ë³´ê³ ì„œ | Master v13</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        :root { --p: #6366f1; --s: #10b981; --bg: #080b14; --card: #1e293b; --text: #e2e8f0; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: var(--text); line-height: 1.7; padding: 20px; }
        .wrap { max-width: 1000px; margin: 0 auto; }
        .card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 20px; padding: 35px; margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1 { font-size: 2.5rem; text-align: center; background: linear-gradient(135deg, #818cf8, #c084fc, #22d3ee); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 900; }
        
        /* ì—…ë¡œë“œ ì˜ì—­ */
        .upload-zone { border: 2px dashed rgba(139,92,246,0.3); border-radius: 16px; padding: 40px; text-align: center; cursor: pointer; transition: 0.3s; background: rgba(139,92,246,0.03); margin: 20px 0; }
        .upload-zone:hover { border-color: var(--p); background: rgba(139,92,246,0.08); }
        input, textarea { width: 100%; padding: 14px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: #fff; margin-bottom: 10px; }
        .btn-main { width: 100%; padding: 20px; background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; border: none; border-radius: 14px; font-weight: 700; cursor: pointer; font-size: 1.2rem; }

        /* PDF ë³´ê³ ì„œ ìŠ¤íƒ€ì¼ êµ¬í˜„ */
        .report-header { border-bottom: 2px solid var(--p); padding-bottom: 15px; margin-bottom: 25px; }
        .section-bar { font-size: 1.5rem; color: #a5b4fc; border-left: 6px solid var(--p); padding-left: 15px; margin: 45px 0 20px; font-weight: 800; display: flex; align-items: center; }
        .keyword-badge { display: inline-block; padding: 5px 15px; background: rgba(99,102,241,0.2); border: 1px solid var(--p); border-radius: 20px; color: #a5b4fc; font-size: 0.9rem; margin: 5px; font-weight: 600; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; background: rgba(0,0,0,0.2); table-layout: fixed; }
        th, td { border: 1px solid rgba(255,255,255,0.1); padding: 15px; text-align: left; vertical-align: top; font-size: 0.9rem; }
        th { background: rgba(99,102,241,0.15); color: #a5b4fc; font-weight: 700; width: 22%; text-align: center; }
        
        .project-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .project-card { background: rgba(255,255,255,0.03); border-radius: 15px; padding: 20px; border-top: 5px solid var(--s); position: relative; }
        .deep-guide-box { background: rgba(16,185,129,0.08); border: 1px solid rgba(16,185,129,0.2); border-radius: 12px; padding: 20px; margin-top: 15px; }
        
        #loading { display: none; text-align: center; padding: 60px; }
        .spinner { border: 5px solid rgba(255,255,255,0.1); border-top: 5px solid var(--p); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="wrap">
    <div class="card" style="text-align: center;">
        <h1>ìƒê¸°ë¶€ ì„±ì¥ ë¶„ì„ ë° 3í•™ë…„ ì „ëµ ë³´ê³ ì„œ</h1>
        <p style="color: rgba(255,255,255,0.4);">Gemini 3.0 Pro ê¸°ë°˜ | ì´ìŠ¹ì€ í•™ìƒ ë³´ê³ ì„œ ì–‘ì‹ ì™„ë²½ êµ¬í˜„</p>
    </div>

    <div class="card">
        <label style="font-size: 0.8rem; color: #a5b4fc;">ğŸ”‘ Gemini API Key</label>
        <input type="password" id="apiKey" placeholder="AI... (Google AI Studioì—ì„œ ë°œê¸‰ë°›ì€ í‚¤)">
        
        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <input type="text" id="name" placeholder="í•™ìƒ ì„±ëª…">
            <input type="text" id="major" placeholder="í¬ë§ ì§„ë¡œ/í•™ê³¼">
        </div>

        <div id="drop-zone" class="upload-zone">
            <div id="upload-status">ğŸ“„ PDF íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
            <input type="file" id="file-input" accept=".pdf" style="display: none;">
        </div>
        <textarea id="rawText" style="display:none;"></textarea>
    </div>

    <button class="btn-main" onclick="runAnalysis()">ğŸ” ìµœì¢… ë³´ê³ ì„œ(PDF ì–‘ì‹) ìƒì„± ì‹œì‘</button>

    <div id="loading">
        <div class="spinner"></div>
        <p>PDF ë³´ê³ ì„œ ì–‘ì‹ì— ë§ì¶° í•™ìƒì˜ ì„±ì¥ ì„œì‚¬ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>

    <div id="result"></div>
</div>

<script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const textArea = document.getElementById('rawText');

    dropZone.onclick = () => fileInput.click();
    fileInput.onchange = (e) => handleFile(e.target.files[0]);
    dropZone.ondragover = (e) => e.preventDefault();
    dropZone.ondrop = async (e) => { e.preventDefault(); handleFile(e.dataTransfer.files[0]); };

    async function handleFile(file) {
        if (!file || file.type !== 'application/pdf') return;
        document.getElementById('upload-status').innerHTML = "â³ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì¤‘...";
        try {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
            let text = '';
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                text += (await page.getTextContent()).items.map(t => t.str).join(' ') + '\n';
            }
            textArea.value = text;
            document.getElementById('upload-status').innerHTML = `âœ… ${file.name} ì¤€ë¹„ ì™„ë£Œ!`;
        } catch(e) { alert("PDF ì¶”ì¶œ ì‹¤íŒ¨"); }
    }

    async function runAnalysis() {
        const key = document.getElementById('apiKey').value.trim();
        const text = textArea.value.trim();
        const sName = document.getElementById('name').value;
        const sMajor = document.getElementById('major').value;

        if(!key || !text) return alert("ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”.");

        document.getElementById('loading').style.display = 'block';
        document.getElementById('result').innerHTML = '';

        // PDF ë³´ê³ ì„œ 5ë‹¨ êµ¬ì„±ì„ ê°•ì œí•˜ëŠ” í”„ë¡¬í”„íŠ¸ (í‚¤ì›Œë“œ í¬í•¨)
        const sys = `ë‹¹ì‹ ì€ ì…ì‹œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì œê³µëœ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ JSONìœ¼ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”.
        {
          "report_info": {"target": "ì„±ëª…", "purpose": "ë¶„ì„ ëª©ì  ìš”ì•½"},
          "core_keywords": ["í‚¤ì›Œë“œ1", "í‚¤ì›Œë“œ2", "í‚¤ì›Œë“œ3", "í‚¤ì›Œë“œ4", "í‚¤ì›Œë“œ5"],
          "growth_table": [
            {"cat": "ì§„ë¡œì—­ëŸ‰", "g1": "1í•™ë…„ ê¸°ì´ˆ", "g2": "2í•™ë…„ ì‹¬í™”", "growth": "ì„±ì¥ íŠ¹ì§•"},
            {"cat": "í•™ì—…ì—­ëŸ‰", "g1": "1í•™ë…„ ê¸°ì´ˆ", "g2": "2í•™ë…„ ì‹¬í™”", "growth": "ì„±ì¥ íŠ¹ì§•"},
            {"cat": "ê³µë™ì²´ì—­ëŸ‰", "g1": "1í•™ë…„ ê¸°ì´ˆ", "g2": "2í•™ë…„ ì‹¬í™”", "growth": "ì„±ì¥ íŠ¹ì§•"},
            {"cat": "ì¸ì„±ì—­ëŸ‰", "g1": "1í•™ë…„ ê¸°ì´ˆ", "g2": "2í•™ë…„ ì‹¬í™”", "growth": "ì„±ì¥ íŠ¹ì§•"}
          ],
          "blue_ocean_projects": [
            {"title": "í”„ë¡œì íŠ¸ëª…", "concept": "ì»¨ì…‰/ì´ë¡ ", "steps": ["ë‹¨ê³„1", "ë‹¨ê³„2", "ë‹¨ê³„3"], "comp": "ê¸°ëŒ€ì—­ëŸ‰/í¬ì¸íŠ¸"}
          ],
          "deep_dive_guides": [
            {"category": "ììœ¨í™œë™", "analysis": "ì—°ì†ì„± ë¶„ì„", "strategy": "ì‹¬í™”/ë§ˆë¬´ë¦¬ ì „ëµ", "book": "ì¶”ì²œë„ì„œ"}
          ],
          "final_vision": "ìµœì¢… ì„±ì¥ ì™„ì„± ëª¨ìŠµ ìš”ì•½"
        }
        ë‚´ìš©ì€ 'ë¬´ì¡°ê±´ì  í™•ì¥'ë³´ë‹¤ 'ê¸°ì¡´ íƒêµ¬ì˜ ì™„ê²°ê³¼ ì‹¬í™”'ë¥¼ ê°•ì¡°í•˜ê³ , ê³ ë“±í•™ìƒ ìˆ˜ì¤€ì„ ë›°ì–´ë„˜ëŠ” í•™ë¬¸ì  ì„±ìˆ™ë„ë¥¼ ë³´ì—¬ì£¼ì„¸ìš”.`;

        try {
            const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=${key}`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    contents: [{parts: [{text: sys + "\n\ní•™ìƒ:" + sName + ", ì§„ë¡œ:" + sMajor + "\n\në°ì´í„°:\n" + text}]}],
                    generationConfig: {response_mime_type: "application/json"}
                })
            });
            const data = await resp.json();
            const res = JSON.parse(data.candidates[0].content.parts[0].text);
            render(res);
        } catch (e) { alert("ë¶„ì„ ì‹¤íŒ¨: API í‚¤ ë˜ëŠ” ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”."); }
        finally { document.getElementById('loading').style.display = 'none'; }
    }

    function render(res) {
        // í•™ìƒ ì •ë³´ ë° í‚¤ì›Œë“œ (Section 1 & 2)
        let keywordsHtml = (res.core_keywords || []).map(k => `<span class="keyword-badge"># ${k}</span>`).join('');
        
        // ì—­ëŸ‰ ë¶„ì„í‘œ (Section 3)
        let tableRows = (res.growth_table || []).map(i => `
            <tr>
                <th>${i.cat}</th>
                <td><strong>1í•™ë…„:</strong> ${i.g1}</td>
                <td><strong>2í•™ë…„:</strong> ${i.g2}</td>
                <td>${i.growth}</td>
            </tr>
        `).join('');

        // í”„ë¡œì íŠ¸ ì œì–¸ (Section 4)
        let projectCards = (res.blue_ocean_projects || []).map(p => `
            <div class="project-card">
                <h4 style="color:var(--s); margin:0 0 10px 0;">${p.title}</h4>
                <p style="font-size:0.85rem; color:#94a3b8; margin-bottom:10px;">${p.concept}</p>
                <ul style="font-size:0.8rem; padding-left:18px; margin-bottom:10px;">
                    ${p.steps.map(s => `<li>${s}</li>`).join('')}
                </ul>
                <p style="font-size:0.75rem; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px; color:var(--s);">ğŸ¯ ${p.comp}</p>
            </div>
        `).join('');

        // ì‹¬í™” ê°€ì´ë“œ (Section 5)
        let guidesHtml = (res.deep_dive_guides || []).map(g => `
            <div class="deep-guide-box">
                <h4 style="color:var(--p); margin-top:0;">${g.category} ì‹¬í™” ë³´ì™„ ì „ëµ</h4>
                <p style="font-size:0.9rem;"><strong>ë¶„ì„:</strong> ${g.analysis}</p>
                <p style="font-size:0.9rem;"><strong>3í•™ë…„ ì „ëµ:</strong> ${g.strategy}</p>
                <p style="font-size:0.85rem; margin-top:10px; color:#a5b4fc;">ğŸ“š <strong>ì¶”ì²œë„ì„œ:</strong> ${g.book}</p>
            </div>
        `).join('');

        document.getElementById('result').innerHTML = `
            <div class="card">
                <div class="report-header">
                    <div style="font-size:0.9rem; color:var(--p);">| 1. ê²€í†  ëŒ€ìƒ í•™ìƒ: ${res.report_info.target}</div>
                    <div style="font-size:0.9rem; color:var(--p); margin-top:5px;">| 2. ê²€í†  ëª©ì : ${res.report_info.purpose}</div>
                </div>
                <div style="text-align:center; margin-top:20px;">
                    <div style="font-size:0.8rem; color:rgba(255,255,255,0.4); margin-bottom:10px;">[í•™ìƒ í•µì‹¬ ì„±ì¥ í‚¤ì›Œë“œ]</div>
                    ${keywordsHtml}
                </div>
            </div>

            <div class="card">
                <div class="section-bar">| 3. 1í•™ë…„ ëŒ€ë¹„ 2í•™ë…„ ì£¼ìš” ì—­ëŸ‰ ì„±ì¥ ë¶„ì„</div>
                <table>
                    <thead><tr><th>í‰ê°€ ì—­ëŸ‰</th><th>1í•™ë…„ (ê¸°ì´ˆ í˜•ì„±)</th><th>2í•™ë…„ (ì—­ëŸ‰ ì‹¬í™”)</th><th>ì£¼ìš” ì„±ì¥ ë‚´ìš©</th></tr></thead>
                    <tbody>${tableRows}</tbody>
                </table>
            </div>

            <div class="card">
                <div class="section-bar">| 4. 3í•™ë…„ 'ë¸”ë£¨ì˜¤ì…˜' í™œë™ ë°©í–¥ ì œì–¸</div>
                <div class="project-grid">${projectCards}</div>
            </div>

            <div class="card">
                <div class="section-bar">| 5. ììœ¨Â·ì§„ë¡œÂ·ë™ì•„ë¦¬ ì‹¬í™” ë³´ì™„ ì „ëµ</div>
                ${guidesHtml}
                <div style="margin-top:30px; padding-top:20px; border-top:2px solid var(--p);">
                    <h4 style="text-align:center; color:var(--p);">[ê¸°ëŒ€ë˜ëŠ” ì„±ì¥ ì™„ì„± ëª¨ìŠµ]</h4>
                    <p style="text-align:center; font-style:italic; font-size:0.95rem; color:#f1f5f9;">"${res.final_vision}"</p>
                </div>
            </div>
        `;
    }
</script>
</body>
</html>
